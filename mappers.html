
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Coupling Code for Numerical Tools - aka ðŸ¥¥ CoCoNuT is a Python tool for partitioned multiphysics simulations with a focus on fluid-structure interaction.">
      
      
      
        <link rel="canonical" href="https://pyfsi.github.io/coconut/mappers.html">
      
      
        <link rel="prev" href="models.html">
      
      
        <link rel="next" href="predictors.html">
      
      
      <link rel="icon" href="assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.20">
    
    
      
        <title>Mappers - CoCoNuT</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mappers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="CoCoNuT" class="md-header__button md-logo" aria-label="CoCoNuT" data-md-component="logo">
      
  <img src="images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CoCoNuT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mappers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pyfsi/coconut" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyfsi/coconut
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="coupling_components.html" class="md-tabs__link">
          
  
  Coupling components

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="data_structure.html" class="md-tabs__link">
        
  
    
  
  Data structure

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="docs.html" class="md-tabs__link">
        
  
    
  
  Documentation

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="examples.html" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="tests.html" class="md-tabs__link">
        
  
    
  
  Tests

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="CoCoNuT" class="md-nav__button md-logo" aria-label="CoCoNuT" data-md-component="logo">
      
  <img src="images/logo.png" alt="logo">

    </a>
    CoCoNuT
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pyfsi/coconut" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyfsi/coconut
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Coupling components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Coupling components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="coupling_components.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="convergence_criteria.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convergence criteria
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Coupled solvers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Coupled solvers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="coupled_solvers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coupled solvers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="models.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Mappers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="mappers.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Mappers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      General concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hierarchy-of-mapping-related-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy of mapping-related objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interpolators-and-transformers" class="md-nav__link">
    <span class="md-ellipsis">
      Interpolators and transformers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-mapper-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Special mapper classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Special mapper classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mapperinterface" class="md-nav__link">
    <span class="md-ellipsis">
      MapperInterface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapperinterpolator" class="md-nav__link">
    <span class="md-ellipsis">
      MapperInterpolator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappertransformer" class="md-nav__link">
    <span class="md-ellipsis">
      MapperTransformer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappercombined" class="md-nav__link">
    <span class="md-ellipsis">
      MapperCombined
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transformers" class="md-nav__link">
    <span class="md-ellipsis">
      Transformers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transformers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mapperpermutation" class="md-nav__link">
    <span class="md-ellipsis">
      MapperPermutation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapperaxisymmetric2dto3d" class="md-nav__link">
    <span class="md-ellipsis">
      MapperAxisymmetric2DTo3D
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapperaxisymmetric3dto2d" class="md-nav__link">
    <span class="md-ellipsis">
      MapperAxisymmetric3DTo2D
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapperdepth2dto3d" class="md-nav__link">
    <span class="md-ellipsis">
      MapperDepth2DTo3D
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapperdepth3dto2d" class="md-nav__link">
    <span class="md-ellipsis">
      MapperDepth3DTo2D
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpolators" class="md-nav__link">
    <span class="md-ellipsis">
      Interpolators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interpolators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mappernearest" class="md-nav__link">
    <span class="md-ellipsis">
      MapperNearest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapperlinear" class="md-nav__link">
    <span class="md-ellipsis">
      MapperLinear
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapperradialbasis" class="md-nav__link">
    <span class="md-ellipsis">
      MapperRadialBasis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="predictors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Predictors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solver wrappers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Solver wrappers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="solver_wrappers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="abaqus.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abaqus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="abaqus_cse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AbaqusCSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fluent.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="kratos_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KratosStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="openfoam.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="python.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="data_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data structure
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="docs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="post_processing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Post-processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Breaking dam
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Breaking dam
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="breaking_dam_fluent2d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="breaking_dam_fluent2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lid-driven cavity
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Lid-driven cavity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lid_driven_cavity_fluent2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lid_driven_cavity_openfoam2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tube
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Tube
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_ringmodel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeRingmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_structure_analytical.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeStructure - Analytical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_structure_surrogate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeStructure - Surrogate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_tube_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Python TubeStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_abaqus2d_steady.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D - Steady
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_abaqus2d_surrogate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D - Surrogate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent3d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 3D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent3d_abaqus3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 3D - Abaqus 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent3d_abaquscse3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 3D - AbaqusCSE 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent3d_kratos_structure3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 3D - KratosStructure 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_openfoam3d_abaqus3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM 3D - Abaqus 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_openfoam3d_kratos_structure3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM 3D - KratosStructure 3D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Turek benchmark
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Turek benchmark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="turek_fluent2d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="turek_fluent2d_abaqus2d_steady.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D - Steady
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="turek_openfoam2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM 2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="test_single_solver.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test single solver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="tests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tests
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="mappers">Mappers</h1>
<p>The coupling interfaces in different solvers are often discretized (meshed) differently, resulting in non-conforming <code>ModelParts</code>. For this reason, mapping is usually required, to transfer data from the output <code>Interface</code> of one solver to the input <code>Interface</code> of another. </p>
<p>The terms <em>from</em> and <em>to</em> will be used to denote respectively the side that provides the original data and the side that receives the mapped data.  </p>
<h2 id="general-concepts">General concepts</h2>
<h3 id="hierarchy-of-mapping-related-objects">Hierarchy of mapping-related objects</h3>
<p>CoCoNuT interacts with the mappers through an instance of the <code>SolverWrapperMapped</code> class. This special solver wrapper appears and behaves exactly the same as real solver wrappers.
It contains 3 <code>Components</code>: a mapper for the input, a real solver wrapper and a mapper for the output.</p>
<p>The two mappers in the <code>SolverWrapperMapped</code> are of a special type: they work on the level of the <a href="https://pyfsi.github.io/coconut/data_structure#interface"><code>Interfaces</code></a>, while the actual mapping will be done on a lower level: the <a href="https://pyfsi.github.io/coconut/data_structure#modelpart"><code>ModelPart</code></a> level. The <code>Interface</code> mapper effectively acts as a <em>wrapper</em> around the actual <code>ModelPart</code> mappers. Currently only one mapper is available on the <code>Interface</code> level, aptly called <code>MapperInterface</code>.</p>
<p>At the lowest level, mappers interpolate variable data (stored in <code>Interfaces</code>) between two <code>ModelParts</code>, based on their coordinates. Interpolation is always done from the <em>from</em> <code>ModelPart</code> to the <em>to</em>-<code>ModelPart</code>.
Multiple <code>ModelPart</code> mappers can be chained together in a <code>MapperCombined</code> object, to add additional functionality, for example swapping the coordinate axes with the <a href="https://pyfsi.github.io/coconut/mappers#mapperpermutation">permutation mapper</a>.</p>
<h3 id="interpolators-and-transformers">Interpolators and transformers</h3>
<p>The <code>ModelPart</code>-level mappers have two main methods: <code>initialize</code> and <code>__call__</code>. 
The <code>initialize</code> method performs one-time expensive operations, such as a nearest-neighbour search and the calculation of interpolation coefficients. 
The <code>__call__</code> method is used for the actual mapping. It takes two tuples as arguments (<em>from</em> and <em>to</em> respectively). Each tuple contains an <code>Interface</code> object, the name of the affected <code>ModelPart</code> and the name of the variable that must be mapped. This method returns nothing: the mapping is done in-place in the <em>to</em>-<code>Interface</code>.</p>
<p>There are two types of <code>ModelPart</code> mappers: <em>interpolators</em> and <em>transformers</em>. They can be distinguished by their superclass. 
All interpolators inherit from the superclass <code>MappedInterpolator</code>. These mappers do the actual interpolation. Currently, <a href="https://pyfsi.github.io/coconut/mappers#mappernearest">a nearest-neighbour mapper</a>, <a href="https://pyfsi.github.io/coconut/mappers#mapperlinear">a linear mapper</a> and a <a href="https://pyfsi.github.io/coconut/mappers#mapperradialbasis">radial basis mapper</a> are available.
All transformers inherit from the superclass <code>MappedTransformer</code>. They provide additional functionality that can be useful during mapping. They do not map values from one point cloud to another like the interpolators, but perform <em>one-sided</em> transformations on the coordinates and/or the data. One example is the permutation transformer: it swaps the coordinate axes of the <code>ModelPart</code> and accordingly the components of vector variables. 
A transformer can never be used by itself, it must always be combined with an interpolator. The reason is that interpolators use information that comes from two sides, which is exactly what the higher-level <code>SolverWrapperMapped</code> and <code>MapperInterface</code> objects are supplying. To chain together multiple <code>ModelPart</code> mappers, the <code>MapperCombined</code> is used: it contains always one interpolator and zero or more transformers, on either side of the interpolator.</p>
<h2 id="special-mapper-classes">Special mapper classes</h2>
<h3 id="mapperinterface"><code>MapperInterface</code></h3>
<p>Class that maps on the level of <code>Interface</code> objects. 
It takes two <code>Interfaces</code>, and maps the <code>ModelParts</code> to each other in the order in which the <code>Interfaces</code> are defined in the JSON file.
The same type of <code>ModelPart</code> mapper is used for each pair of <code>ModelParts</code>: this can either be an interpolator or a combined mapper. To use a different <code>ModelPart</code> mapper for the different <code>ModelParts</code> in the <code>Interface</code>, or even for different variables, a new <code>Interface</code> mapper would have to be written. </p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><code>type</code></td>
<td style="text-align: center;">str</td>
<td><code>ModelPart</code> mapper to be used.</td>
</tr>
<tr>
<td style="text-align: right;"><nobr><code>settings</code></nobr></td>
<td style="text-align: center;">dict</td>
<td>All the settings for the <code>ModelPart</code> mapper specified in <code>type</code>.</td>
</tr>
</tbody>
</table>
<h3 id="mapperinterpolator"><code>MapperInterpolator</code></h3>
<p>Superclass for all <a href="https://pyfsi.github.io/coconut/mappers#interpolators">interpolators</a>. </p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><code>balanced_tree</code></td>
<td style="text-align: center;">bool</td>
<td>(optional) Default: <code>false</code>. If set to <code>true</code> a balanced <code>cKDTree</code> is created, which is more stable, but takes longer to build. Set to <code>true</code> in the rare case that the tree gives problems.</td>
</tr>
<tr>
<td style="text-align: right;"><nobr><code>check_bounding_box</code></nobr></td>
<td style="text-align: center;">bool</td>
<td>(optional) Default: <code>true</code>. If <code>true</code> it is checked if the bounding boxes of the <em>from</em>- and <em>to</em>-<code>ModelParts</code> overlap in the provided mapping <code>directions</code>.</td>
</tr>
<tr>
<td style="text-align: right;"><code>directions</code></td>
<td style="text-align: center;">list</td>
<td>List of coordinate directions, maximum three entries, may contain <code>"x"</code>, <code>"y"</code>, <code>"z"</code>.</td>
</tr>
<tr>
<td style="text-align: right;"><code>scaling</code></td>
<td style="text-align: center;">list</td>
<td>(optional) Default: no scaling. List of scaling factors, must be same length as <code>directions</code>. Coordinates are scaled with these factors, this may improve interpolation e.g. when cells have a high aspect ratio with respect to one of the axes.</td>
</tr>
</tbody>
</table>
<p>The <code>initialize</code> method must be defined in all child classes. It takes as arguments the <em>from</em>-<code>ModelPart</code> and the <em>to</em>-<code>ModelPart</code>. It does the following:</p>
<ul>
<li>read and store the coordinates from the <em>from</em>- and <em>to</em>-<code>ModelParts</code>,</li>
<li>scale coordinates if necessary,</li>
<li>check if the bounding boxes of the <em>from</em>- and <em>to</em>-<code>ModelParts</code> overlap,</li>
<li>do an efficient nearest neighbour search using <code>scipy.spatial.cKDTree</code>,</li>
<li>check if the <em>from</em>-<code>ModelPart</code> does not contain duplicate coordinates.</li>
</ul>
<p>The <code>__call__</code> method should not be overridden in the child classes. It interpolates data based on coefficients that are calculated in the <code>initialize</code> method of the child classes. Both scalar and vector variables can be mapped.</p>
<h3 id="mappertransformer"><code>MapperTransformer</code></h3>
<p>Superclass for all <a href="https://pyfsi.github.io/coconut/mappers#transformers">transformers</a>. A transformer cannot be used as a standalone mapper, but will always be part of a combined mapper. </p>
<p>The <code>initialization</code> of transformers is very different from that of interpolators. A transformer is initialized from one side (either the <em>from</em> or the <em>to</em> side), i.e. based on a single <code>ModelPart</code>. From this input <code>ModelPart</code>, the <code>initialize</code> method creates and returns another <code>ModelPart</code> that is stored and used in the combined mapper. </p>
<h3 id="mappercombined"><code>MapperCombined</code></h3>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>mappers</code></nobr></td>
<td style="text-align: center;">list</td>
<td>An ordered list of all the <code>ModelPart</code> mappers to be used.</td>
</tr>
</tbody>
</table>
<p>The <code>MapperCombined</code> is used to chain together multiple mappers. It always contains a single interpolator and zero or more transformers, which can be on either side of the interpolator. If transformers are present, <em>intermediate</em> <code>ModelParts</code> are created during initialization. This is done by working <em>inwards</em> towards the interpolator. This means that transformers upstream of the interpolator, are initialized based on the <em>from</em>-<code>ModelPart</code> (input), while downstream transformers are initialized based on the <em>to</em>-<code>ModelPart</code> (output). 
Some transformers can only be initialized in one direction, e.g. for <code>MapperAxisymmetric3DTo2D</code>, the 2D <em>to</em>-<code>ModelPart</code> must be supplied, therefore this transformer must be downstream of the interpolator. </p>
<p>These concepts are clarified further using an excerpt from the JSON file of the <em>Fluent 3D - Abaqus 2D</em> tube example: </p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mappers.combined&quot;</span><span class="p">,</span>
<span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;mappers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mappers.permutation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;permutation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]}},</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mappers.radial_basis&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;directions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;z&quot;</span><span class="p">]}},</span>
<span class="w">        </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mappers.axisymmetric_3d_to_2d&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;direction_axial&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;direction_radial&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;n_tangential&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">}}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
This combined mapper contains 3 <code>ModelPart</code> mappers. In the <code>initialize</code> method, the following happens (in this order):</p>
<ul>
<li>A first intermediate <code>ModelPart</code> is created by calling the <code>initialize</code> method of the permutation transformer. This is done by swapping the x and y coordinates of the <em>from</em>-<code>ModelPart</code>. </li>
<li>A second intermediate <code>ModelPart</code> is created by calling the <code>initialize</code> method of the axisymmetric transformer. The coordinates of the 2D <em>to</em>-<code>ModelPart</code> are used to create the 3D intermediate <code>ModelPart</code> by adding points in the circumferential direction.</li>
<li>The mapping coefficients of the radial basis interpolator are calculated by calling its <code>initialize</code> method. The first intermediate <code>ModelPart</code> is used as <em>from</em>-<code>ModelPart</code>, the second intermediate <code>ModelPart</code> is used as <em>to</em>-<code>ModelPart</code>.</li>
</ul>
<p>When the <code>__call__</code> method  of the combined mapper is used, the following happens (in this order):</p>
<ul>
<li>The <em>from</em>-data (stored in the <em>from</em>-<code>Interface</code>) is mapped from the <em>from</em>-<code>ModelPart</code> to the first intermediate <code>ModelPart</code> using the <code>__call__</code> method of the permutation mapper: scalar variables are unchanged, vector variables are permuted. </li>
<li>The resulting data is now interpolated to the second intermediate <code>ModelPart</code>, using the <code>__call__</code> method of the radial basis mapper. </li>
<li>Finally, that data is mapped to the <em>to</em>-<code>ModelPart</code> using the <code>__call__</code> method of the axisymmetric transformer, reducing it from 3D to 2D. That data is written to the <em>to</em>-<code>Interface</code>. </li>
</ul>
<h2 id="transformers">Transformers</h2>
<h3 id="mapperpermutation"><code>MapperPermutation</code></h3>
<p>Permutates the coordinates and the vector variables according to the given <code>permutation</code>. 
This transformer can be initialized in both directions. </p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>permutation</code></nobr></td>
<td style="text-align: center;">list</td>
<td>A permutation of the list [0, 1, 2].</td>
</tr>
</tbody>
</table>
<h3 id="mapperaxisymmetric2dto3d"><code>MapperAxisymmetric2DTo3D</code></h3>
<p>Transforms a 2D axisymmetric geometry to a 3D geometry. This transformer can only be initialized in the <em>forward</em> direction, i.e. based on the 2D axisymmetric <code>ModelPart</code>. Therefore, it should be <em>upstream</em> of the interpolator in the combined mapper.</p>
<p>The 3D <code>ModelPart</code> is returned by the initialization.<code>angle</code> defines the 3D geometry and is based on the geometry of the 3D solver, e.g. the geometry of an axisymmtric simulation with an OpenFoam solver is defined with an angle of 5Â°.  <code>n_tangential</code> specifies the number of points in the tangential (circumferential) direction, so that for each point in the 2D <code>ModelPart</code>, <code>n_tangential</code> points are created in the 3D <code>ModelPart</code>. It is important to make the value of <code>n_tangential</code> large enough, ideally close to the number of points in the tangential direction in the 3D solver. The code knows which directions are axial, radial and tangential thanks to the input parameters <code>direction_axial</code> and <code>direction_radial</code>. </p>
<p>It is not possible to change the axial direction between 2D and 3D: a separate <code>MapperPermutation</code> should be added to the combined mapper for that purpose. </p>
<p>Scalar data is simply copied from the 2D point to all corresponding 3D points. For vector data, the axial component is simply copied, the radial component is rotated. The tangential component (e.g. swirl) is not taken into account currently.</p>
<p>Points that lie on the symmetry axis can not be handled by the current transformer.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><code>direction_axial</code></td>
<td style="text-align: center;">str</td>
<td>Must be <code>"x"</code>, <code>"y"</code> or <code>"z"</code>, specifies the symmetry axis.</td>
</tr>
<tr>
<td style="text-align: right;"><nobr><code>direction_radial</code></nobr></td>
<td style="text-align: center;">str</td>
<td>Must be <code>"x"</code>, <code>"y"</code> or <code>"z"</code>, specifies the second (radial) axis in 2D.</td>
</tr>
<tr>
<td style="text-align: right;"><code>n_tangential</code></td>
<td style="text-align: center;">int</td>
<td>Degrees of freedom in tangential (circumferential) direction of 3D <code>ModelPart</code> that is created during initialization. The minimum setting of n_tangential points depends of the definition of the angle.</td>
</tr>
<tr>
<td style="text-align: right;"><code>angle</code></td>
<td style="text-align: center;">int</td>
<td>(optional) Default: <code>360</code>. Angle of the (partial) 3D cylinder constructed from the 2D geometry, centred around the radial direction.</td>
</tr>
</tbody>
</table>
<h3 id="mapperaxisymmetric3dto2d"><code>MapperAxisymmetric3DTo2D</code></h3>
<p>Transforms a 3D geometry to a 2D axisymmetric geometry. This transformer can only be initialized in the <em>backward</em> direction, i.e. based on the 2D axisymmetric <code>ModelPart</code>. Therefore, it should be <em>downstream</em> of the interpolator in the combined mapper.</p>
<p>For scalar data, the circumferential average is taken for each 2D point. For vector data too, taking into account the correct radial direction in each 3D point.  Again, swirl cannot be taken into account: if a tangential component is present in 3D, it is not transferred to 2D. </p>
<p>More information and JSON settings can be found under <a href="https://pyfsi.github.io/coconut/mappers#mapperaxisymmetric2dto3d"><code>MapperAxisymmetric2DTo3D</code></a>.</p>
<h3 id="mapperdepth2dto3d"><code>MapperDepth2DTo3D</code></h3>
<p>Transforms a 2D geometry to a 3D geometry, by extruding in a <em>depth</em> direction. This transformer can only be initialized in the <em>forward</em> direction, i.e. based on the 2D axisymmetric <code>ModelPart</code>. Therefore, it should be <em>upstream</em> of the interpolator in the combined mapper.</p>
<p>The 3D <code>ModelPart</code> is returned by the initialization. The depth direction in which the 2D <code>ModelPart</code> is extended, is specified by <code>direction_depth</code>. This direction has to be along one of the principal axes: x, y and z. The number of nodes in the depth direction and their location are given by the list <code>coordinates_depth</code>.</p>
<p>Scalar data is simply copied from the 2D point to all corresponding 3D points. For vector data, all components other than the depth component are simply copied. The depth component is set to zero.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>coordinates_depth</code></nobr></td>
<td style="text-align: center;">list</td>
<td>Contains the depth coordinates to which the nodes of the orignal 2D plane are copied.</td>
</tr>
<tr>
<td style="text-align: right;"><code>direction_depth</code></td>
<td style="text-align: center;">str</td>
<td>Must be <code>"x"</code>, <code>"y"</code> or <code>"z"</code>, specifies the symmetry axis.</td>
</tr>
</tbody>
</table>
<h3 id="mapperdepth3dto2d"><code>MapperDepth3DTo2D</code></h3>
<p>Transforms a 3D geometry to a 2D axisymmetric geometry, by collapsing in a <em>depth</em> direction. This transformer can only be initialized in the <em>backward</em> direction, i.e. based on the 2D axisymmetric <code>ModelPart</code>. Therefore, it should be <em>downstream</em> of the interpolator in the combined mapper.</p>
<p>For scalar data, the average is taken for each 2D point. For vector data too, again removing the depth component.</p>
<p>More information and JSON settings can be found under <a href="https://pyfsi.github.io/coconut/mappers#mapperdepth2dto3d"><code>MapperDepth2DTo3D</code></a>.</p>
<h2 id="interpolators">Interpolators</h2>
<h3 id="mappernearest"><code>MapperNearest</code></h3>
<p>Does not require additional settings compared to the <code>MapperInterpolator</code>. Does simple nearest-neighbour mapping.</p>
<h3 id="mapperlinear"><code>MapperLinear</code></h3>
<p>Additional settings:</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>parallel</code></nobr></td>
<td style="text-align: center;">bool</td>
<td>(optional) Default: <code>false</code>. If <code>true</code> the package <code>multiprocessing</code> is used to parallellize the loop that the calculates the interpolation coefficients. This is only useful for <code>ModelParts</code> with a very high number of degrees of freedom.</td>
</tr>
</tbody>
</table>
<p>The kind of linear mapping depends on the number of coordinate directions, as given in the <code>directions</code> setting.</p>
<p><strong>1D:</strong> If the <em>to</em>-point lies between the 2 nearest <em>from</em>-points, linear interpolation is done. Else, nearest neighbour interpolation is done.</p>
<p><strong>2D:</strong> The <em>to</em>-point is first projected on the line through the 2 nearest <em>from</em>-points. If the projected point lies between the <em>from</em>-points, linear interpolation is done. Else, nearest neighbour interpolation is done.</p>
<p><strong>3D:</strong> The <em>to</em>-point is first projected on the plane through the 3 nearest <em>from</em>-points. If the triangle consisting of those 3 points is <em>deprecated</em> (colinear points), the 2D-methodology is followed. Else, if the projected point lies inside the triangle, barycentric interpolation is done. If it lies outside the triangle, the 2D-methodology is followed.</p>
<h3 id="mapperradialbasis"><code>MapperRadialBasis</code></h3>
<p>Additional settings:</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><code>include_polynomial</code></td>
<td style="text-align: center;">bool</td>
<td>(optional) Default: <code>true</code>. If <code>true</code> a polynomial is included in the radial basis function as described below.</td>
</tr>
<tr>
<td style="text-align: right;"><code>n_nearest</code></td>
<td style="text-align: center;">int</td>
<td>(optional) Default: <code>81</code>, if mapping in 3 <code>directions</code>, else <code>9</code>. Number of nearest neighbours used to perform mapping.</td>
</tr>
<tr>
<td style="text-align: right;"><nobr><code>parallel</code></nobr></td>
<td style="text-align: center;">bool</td>
<td>(optional) Default: <code>false</code>. If <code>true</code> the package <code>multiprocessing</code> is used to parallellize the loop that the calculates the interpolation coefficients. This is only useful for <code>ModelParts</code> with a very high number of degrees of freedom.</td>
</tr>
<tr>
<td style="text-align: right;"><nobr><code>shape_parameter</code></nobr></td>
<td style="text-align: center;">int</td>
<td>(optional) Default: <code>200</code>. Should be chosen as large as possible without rendering the interpolation matrix ill-conditioned.</td>
</tr>
</tbody>
</table>
<p>Radial basis function interpolation is relatively straightforward: implementation for 1D, 2D and 3D is exactly the same and can be written in a condensed way using <code>scipy.spatial.distance</code>. </p>
<p>Normal radial basis interpolation is done as follows.
<span class="arithmatex"><span class="MathJax_Preview">\phi(r)</span><script type="math/tex">\phi(r)</script></span> is a radial basis function defined as  </p>
<div class="arithmatex">
<div class="MathJax_Preview">
\phi(r) = 
\begin{cases}
    (1-\frac{r}{d_{ref}})^4 (1 + 4\frac{r}{d_{ref}}) \quad &amp;\mathrm{for} \quad 0 \leq \frac{r}{d_{ref}} &lt; 1 \\
    0 &amp;\mathrm{for} \quad 1 \leq \frac{r}{d_{ref}}
\end{cases}
</div>
<script type="math/tex; mode=display">
\phi(r) = 
\begin{cases}
    (1-\frac{r}{d_{ref}})^4 (1 + 4\frac{r}{d_{ref}}) \quad &\mathrm{for} \quad 0 \leq \frac{r}{d_{ref}} < 1 \\
    0 &\mathrm{for} \quad 1 \leq \frac{r}{d_{ref}}
\end{cases}
</script>
</div>
<p>with <span class="arithmatex"><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> a positive distance. To control the width of the function, <span class="arithmatex"><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> is scaled with a reference distance <span class="arithmatex"><span class="MathJax_Preview">d_{ref}</span><script type="math/tex">d_{ref}</script></span>.</p>
<p>Assume that <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> nearest <em>from</em>-points will be used in the interpolation.
An unknown function <span class="arithmatex"><span class="MathJax_Preview">f(\boldsymbol{x})</span><script type="math/tex">f(\boldsymbol{x})</script></span> can then be approximated as the weighted sum of <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> shifted radial basis functions:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
f(\boldsymbol{x}) = \sum_j \alpha_j \phi(||\boldsymbol{x} - \boldsymbol{x}_j||).
</div>
<script type="math/tex; mode=display">
f(\boldsymbol{x}) = \sum_j \alpha_j \phi(||\boldsymbol{x} - \boldsymbol{x}_j||).
</script>
</div>
<p>To determine the coefficients <span class="arithmatex"><span class="MathJax_Preview">\alpha_j</span><script type="math/tex">\alpha_j</script></span>, we require that the exact function value is returned at the <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> <em>from</em>-points.
This gives us <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> equations</p>
<div class="arithmatex">
<div class="MathJax_Preview">
f(\boldsymbol{x}_i) = f_i = \sum_j \alpha_j \phi(||\boldsymbol{x}_i - \boldsymbol{x}_j||)
</div>
<script type="math/tex; mode=display">
f(\boldsymbol{x}_i) = f_i = \sum_j \alpha_j \phi(||\boldsymbol{x}_i - \boldsymbol{x}_j||)
</script>
</div>
<p>which can be written in matrix form as</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\boldsymbol{f} = \boldsymbol{\Phi} \boldsymbol{\alpha}
</div>
<script type="math/tex; mode=display">
\boldsymbol{f} = \boldsymbol{\Phi} \boldsymbol{\alpha}
</script>
</div>
<p>with <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{f}, \boldsymbol{\alpha} \in \mathbb{R}^{n \times 1}</span><script type="math/tex">\boldsymbol{f}, \boldsymbol{\alpha} \in \mathbb{R}^{n \times 1}</script></span>, and <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\Phi} \in \mathbb{R}^{n \times n}</span><script type="math/tex">\boldsymbol{\Phi} \in \mathbb{R}^{n \times n}</script></span>. This system can be solved for the weights-vector <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\alpha}</span><script type="math/tex">\boldsymbol{\alpha}</script></span>.</p>
<p>However, in our case, the <em>from</em>-point values vector <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{f}</span><script type="math/tex">\boldsymbol{f}</script></span> is not known in advance: it contains the values of the <code>variable</code> that will be interpolated. </p>
<p>Therefore, the approximation to calculate the interpolation in the <em>to</em>-point is rewritten as follows:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
f(\boldsymbol{x}_{to}) = \sum_j \alpha_j \phi(||\boldsymbol{x}_{to} - \boldsymbol{x}_j||) = \boldsymbol{\Phi}_{to}^T \boldsymbol{\alpha} = \boldsymbol{\Phi}_{to}^T \boldsymbol{\Phi}^{-1} \boldsymbol{f} = \boldsymbol{c}^T \boldsymbol{f}.
</div>
<script type="math/tex; mode=display">
f(\boldsymbol{x}_{to}) = \sum_j \alpha_j \phi(||\boldsymbol{x}_{to} - \boldsymbol{x}_j||) = \boldsymbol{\Phi}_{to}^T \boldsymbol{\alpha} = \boldsymbol{\Phi}_{to}^T \boldsymbol{\Phi}^{-1} \boldsymbol{f} = \boldsymbol{c}^T \boldsymbol{f}.
</script>
</div>
<p>The coefficients vector <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{c}</span><script type="math/tex">\boldsymbol{c}</script></span> can now be calculated based only on the coordinates by solving the system</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\boldsymbol{\Phi} \ \boldsymbol{c} = \boldsymbol{\Phi}_{to}.
</div>
<script type="math/tex; mode=display">
\boldsymbol{\Phi} \ \boldsymbol{c} = \boldsymbol{\Phi}_{to}.
</script>
</div>
<p>As every to-point has different nearest neighbours in the <em>from</em>-points, the coefficient vector <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{c}</span><script type="math/tex">\boldsymbol{c}</script></span> must be calculated for each <em>to</em>-point independently. The matrix <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\Phi}</span><script type="math/tex">\boldsymbol{\Phi}</script></span> and vector <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\Phi}_{to}</span><script type="math/tex">\boldsymbol{\Phi}_{to}</script></span> must also be calculated for every <em>to</em>-point independently.</p>
<p><strong>The shape parameter</strong></p>
<p>For every <em>to</em>-point, the reference distance <span class="arithmatex"><span class="MathJax_Preview">d_{ref}</span><script type="math/tex">d_{ref}</script></span> is determined as the product of the <code>shape_parameter</code> and the distance between the <em>to</em>-point and the furthest <em>from</em>-point.</p>
<p>In order to ensure that the basis function of each of the nearest <em>from</em>-points covers every <em>from</em>-point, the <code>shape_parameter</code> should be larger than two.
This value may however lead to an interpolation function which consists of sharp peaks or wiggles, with the correct value near the <em>from</em>-points, but a deviating value away from them.</p>
<p>In the extreme case of <span class="arithmatex"><span class="MathJax_Preview">d_{ref}</span><script type="math/tex">d_{ref}</script></span> approaching zero, the so-called "bed-of-nails interpolant" is obtained, which is close to zero everywhere, except near the <em>from</em>-points where it sharply peaks.
In this case the interpolation matrix approaches the identity matrix.</p>
<p>Choosing a higher value improves the interpolation as the basis functions become wider, but the interpolation matrix becomes less stable, i.e. the condition number increases.
The default value is 200.
In practice, the <code>shape_parameter</code> is chosen so that the interpolation matrix is "on the edge of ill-conditioning" (for example, with a condition number of roughly <span class="arithmatex"><span class="MathJax_Preview">10^{13}</span><script type="math/tex">10^{13}</script></span> for double-precision floating point).
A warning is printed when the condition number of an interpolation matrix becomes higher than <span class="arithmatex"><span class="MathJax_Preview">10^{13}</span><script type="math/tex">10^{13}</script></span>. Refer also to Lombardi et al. [<a href="#1">1</a>].</p>
<p><strong>Adding a polynomial</strong></p>
<p>Adding a linear polynomial <span class="arithmatex"><span class="MathJax_Preview">p(\boldsymbol{x})</span><script type="math/tex">p(\boldsymbol{x})</script></span></p>
<div class="arithmatex">
<div class="MathJax_Preview">
p(\boldsymbol{x}) = \beta_0 + \beta_1 x_1 + \dots + \beta_d x_d,
</div>
<script type="math/tex; mode=display">
p(\boldsymbol{x}) = \beta_0 + \beta_1 x_1 + \dots + \beta_d x_d,
</script>
</div>
<p>with <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> the dimension of <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{x}</span><script type="math/tex">\boldsymbol{x}</script></span>, to the radial basis interpolant allows to exactly capture linear variations in <em>from</em>-point values:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
f(\boldsymbol{x}) = \sum_j \alpha_j \phi(||\boldsymbol{x} - \boldsymbol{x}_j||) + p(\boldsymbol{x}).
</div>
<script type="math/tex; mode=display">
f(\boldsymbol{x}) = \sum_j \alpha_j \phi(||\boldsymbol{x} - \boldsymbol{x}_j||) + p(\boldsymbol{x}).
</script>
</div>
<p>To determine the coefficients <span class="arithmatex"><span class="MathJax_Preview">\alpha_j</span><script type="math/tex">\alpha_j</script></span> and <span class="arithmatex"><span class="MathJax_Preview">\beta_j</span><script type="math/tex">\beta_j</script></span>, additional conditions are required next to matching the exact function values at the <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> <em>from</em>-points.
Therefore, we impose that</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\sum_j \alpha_j q(\boldsymbol{x}_j) = 0
</div>
<script type="math/tex; mode=display">
\sum_j \alpha_j q(\boldsymbol{x}_j) = 0
</script>
</div>
<p>for all polynomials <span class="arithmatex"><span class="MathJax_Preview">q</span><script type="math/tex">q</script></span> with a degree lower than the degree of <span class="arithmatex"><span class="MathJax_Preview">p</span><script type="math/tex">p</script></span>.
These conditions can be written in matrix form as </p>
<div class="arithmatex">
<div class="MathJax_Preview">
    \begin{bmatrix}
    \boldsymbol{f} \\
    \boldsymbol{0} \\
    \end{bmatrix}
=
    \begin{bmatrix}
    \boldsymbol{\Phi} &amp; \boldsymbol{P} \\
    \boldsymbol{P}^T &amp; \boldsymbol{0} \\
    \end{bmatrix}
    \begin{bmatrix}
    \boldsymbol{\alpha} \\
    \boldsymbol{\beta} \\
    \end{bmatrix}.
</div>
<script type="math/tex; mode=display">
    \begin{bmatrix}
    \boldsymbol{f} \\
    \boldsymbol{0} \\
    \end{bmatrix}
=
    \begin{bmatrix}
    \boldsymbol{\Phi} & \boldsymbol{P} \\
    \boldsymbol{P}^T & \boldsymbol{0} \\
    \end{bmatrix}
    \begin{bmatrix}
    \boldsymbol{\alpha} \\
    \boldsymbol{\beta} \\
    \end{bmatrix}.
</script>
</div>
<p>with <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{P} \in \mathbb{R}^{n \times (d+1)}</span><script type="math/tex">\boldsymbol{P} \in \mathbb{R}^{n \times (d+1)}</script></span>, and <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\beta} \in \mathbb{R}^{(d+1) \times 1}</span><script type="math/tex">\boldsymbol{\beta} \in \mathbb{R}^{(d+1) \times 1}</script></span>.</p>
<p>As before, this system can be solved for the vectors <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\alpha}</span><script type="math/tex">\boldsymbol{\alpha}</script></span> and <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\beta}</span><script type="math/tex">\boldsymbol{\beta}</script></span> with the <em>from</em>-point values (each time the mapper is used), but it is less expensive to construct the vector <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{c} \in \mathbb{R}^{n \times 1}</span><script type="math/tex">\boldsymbol{c} \in \mathbb{R}^{n \times 1}</script></span> (once, when the mapper is initialized) as follows:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
f(\boldsymbol{x}_{to}) = \sum_j \alpha_j \phi(||\boldsymbol{x}_{to} - \boldsymbol{x}_j||) + p(\boldsymbol{x}_{to}) = {\boldsymbol{\Phi}_{to}}^T \boldsymbol{\alpha} + {\boldsymbol{P}_{to}}^T \boldsymbol{\beta} 
%=
%    \begin{bmatrix}
%    {\boldsymbol{\Phi}_{to}}^T &amp; {\boldsymbol{P}_{to}}^T \\
%    \end{bmatrix}
%    \begin{bmatrix}
%    \boldsymbol{\alpha} \\
%    \boldsymbol{\beta} \\
%    \end{bmatrix}
=
    \begin{bmatrix}
    {\boldsymbol{\Phi}_{to}}^T &amp; {\boldsymbol{P}_{to}}^T \\
    \end{bmatrix}
    {\begin{bmatrix}
    \boldsymbol{\Phi} &amp; \boldsymbol{P} \\
    \boldsymbol{P}^T &amp; \boldsymbol{0} \\
    \end{bmatrix}}^{-1}
    \begin{bmatrix}
    \boldsymbol{f} \\
    \boldsymbol{0} \\
    \end{bmatrix}
=
    \begin{bmatrix}
    \boldsymbol{c}^T &amp; \dots \\
    \end{bmatrix}
    \begin{bmatrix}
    \boldsymbol{f} \\
    \boldsymbol{0} \\
    \end{bmatrix}
= \boldsymbol{c}^T \boldsymbol{f}.
</div>
<script type="math/tex; mode=display">
f(\boldsymbol{x}_{to}) = \sum_j \alpha_j \phi(||\boldsymbol{x}_{to} - \boldsymbol{x}_j||) + p(\boldsymbol{x}_{to}) = {\boldsymbol{\Phi}_{to}}^T \boldsymbol{\alpha} + {\boldsymbol{P}_{to}}^T \boldsymbol{\beta} 
%=
%    \begin{bmatrix}
%    {\boldsymbol{\Phi}_{to}}^T & {\boldsymbol{P}_{to}}^T \\
%    \end{bmatrix}
%    \begin{bmatrix}
%    \boldsymbol{\alpha} \\
%    \boldsymbol{\beta} \\
%    \end{bmatrix}
=
    \begin{bmatrix}
    {\boldsymbol{\Phi}_{to}}^T & {\boldsymbol{P}_{to}}^T \\
    \end{bmatrix}
    {\begin{bmatrix}
    \boldsymbol{\Phi} & \boldsymbol{P} \\
    \boldsymbol{P}^T & \boldsymbol{0} \\
    \end{bmatrix}}^{-1}
    \begin{bmatrix}
    \boldsymbol{f} \\
    \boldsymbol{0} \\
    \end{bmatrix}
=
    \begin{bmatrix}
    \boldsymbol{c}^T & \dots \\
    \end{bmatrix}
    \begin{bmatrix}
    \boldsymbol{f} \\
    \boldsymbol{0} \\
    \end{bmatrix}
= \boldsymbol{c}^T \boldsymbol{f}.
</script>
</div>
<p>As before, the coefficients vector <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{c}</span><script type="math/tex">\boldsymbol{c}</script></span> can now be calculated based only on the coordinates by solving the system</p>
<div class="arithmatex">
<div class="MathJax_Preview">
    \begin{bmatrix}
    \boldsymbol{\Phi} &amp; \boldsymbol{P} \\
    \boldsymbol{P}^T &amp; \boldsymbol{0} \\
    \end{bmatrix}
    \begin{bmatrix}
    \boldsymbol{c} \\
    \dots \\
    \end{bmatrix}
=
    \begin{bmatrix}
    \boldsymbol{\Phi}_{to} \\
    \boldsymbol{P}_{to} \\
    \end{bmatrix}.
</div>
<script type="math/tex; mode=display">
    \begin{bmatrix}
    \boldsymbol{\Phi} & \boldsymbol{P} \\
    \boldsymbol{P}^T & \boldsymbol{0} \\
    \end{bmatrix}
    \begin{bmatrix}
    \boldsymbol{c} \\
    \dots \\
    \end{bmatrix}
=
    \begin{bmatrix}
    \boldsymbol{\Phi}_{to} \\
    \boldsymbol{P}_{to} \\
    \end{bmatrix}.
</script>
</div>
<p>For details refer to Degroote and Vierendeels [<a href="#2">2</a>].</p>
<p>Note that when the from-points are collinear (in 2d or 3d) or coplanar (in 3d), the linear polynomial <span class="arithmatex"><span class="MathJax_Preview">p(\boldsymbol{x})</span><script type="math/tex">p(\boldsymbol{x})</script></span> is not uniquely defined.
Then, the corresponding hyperplane is chosen such that there is no change in value when moving orthogonal to the line or plane formed by the <em>from</em>-points.</p>
<p><a id="1">[1]</a>
<a href="https://doi.org/10.1016/j.cma.2012.12.019">Lombardi M., Parolini N. and Quarteroni A., "Radial basis functions for inter-grid interpolation and mesh motion in FSI problems", Computer Methods in Applied Mechanics and Engineering, vol. 256, pp. 117-131, 2013.</a></p>
<p><a id="2">[2]</a>
<a href="http://doi.org/10.1016/j.cma.2012.03.010">Degroote J. and Vierendeels J., "Multi-level quasi-Newton coupling algorithms for the partitioned simulation of fluidâ€“structure interaction", Computer Methods in Applied Mechanics and Engineering, vol. 225-228, pp. 14-27, 2012.</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.expand", "navigation.tracking", "toc.integrate", "content.code.copy", "content.code.annotate"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.dd8806f2.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>