
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="site_description">
      
      
      
      
        <link rel="prev" href="coupled_solvers.html">
      
      
        <link rel="next" href="mappers.html">
      
      
      <link rel="icon" href="assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.11">
    
    
      
        <title>Models - CoCoNuT</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="CoCoNuT" class="md-header__button md-logo" aria-label="CoCoNuT" data-md-component="logo">
      
  <img src="images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CoCoNuT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pyfsi/coconut" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyfsi/coconut
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="coupling_components.html" class="md-tabs__link">
          
  
  Coupling components

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="data_structure.html" class="md-tabs__link">
        
  
    
  
  Data structure

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="docs.html" class="md-tabs__link">
        
  
    
  
  Documentation

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="examples.html" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="tests.html" class="md-tabs__link">
        
  
    
  
  Tests

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="CoCoNuT" class="md-nav__button md-logo" aria-label="CoCoNuT" data-md-component="logo">
      
  <img src="images/logo.png" alt="logo">

    </a>
    CoCoNuT
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pyfsi/coconut" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyfsi/coconut
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Coupling components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Coupling components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="coupling_components.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="convergence_criteria.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convergence criteria
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Coupled solvers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Coupled solvers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="coupled_solvers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coupled solvers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Models
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="models.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#common-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Common methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jacobian-approximation-from-secant-information" class="md-nav__link">
    <span class="md-ellipsis">
      Jacobian approximation from secant information
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jacobian approximation from secant information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#least-squares" class="md-nav__link">
    <span class="md-ellipsis">
      Least-squares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-vector" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-vector-matrix-free" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-vector matrix-free
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jacobian-approximation-from-surrogate-model" class="md-nav__link">
    <span class="md-ellipsis">
      Jacobian approximation from surrogate model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jacobian approximation from surrogate model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#surrogate" class="md-nav__link">
    <span class="md-ellipsis">
      Surrogate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapped" class="md-nav__link">
    <span class="md-ellipsis">
      Mapped
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analytically-determined-jacobian" class="md-nav__link">
    <span class="md-ellipsis">
      Analytically determined Jacobian
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analytically determined Jacobian">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#analytical-1d" class="md-nav__link">
    <span class="md-ellipsis">
      Analytical 1D
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    <span class="md-ellipsis">
      Restart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dummy-model" class="md-nav__link">
    <span class="md-ellipsis">
      Dummy model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mappers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mappers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="predictors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Predictors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solver wrappers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Solver wrappers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="solver_wrappers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="abaqus.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abaqus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fluent.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="kratos_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KratosStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="openfoam.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="python.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="data_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data structure
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="docs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Breaking dam
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Breaking dam
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="breaking_dam_fluent2d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="breaking_dam_fluent2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lid-driven cavity
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Lid-driven cavity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lid_driven_cavity_fluent2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lid_driven_cavity_openfoam2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tube
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Tube
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_ringmodel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeRingmodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_structure_analytical.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeStructure - Analytical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_tube_structure_surrogate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Python TubeStructure - Surrogate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_tube_flow_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python TubeFlow - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_tube_structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Python TubeStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_abaqus2d_steady.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D - Steady
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent2d_abaqus2d_surrogate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D - Surrogate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent3d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 3D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent3d_abaqus3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 3D - Abaqus 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_fluent3d_kratos_structure3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 3D - KratosStructure 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_openfoam3d_abaqus3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM 3D - Abaqus 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tube_openfoam3d_kratos_structure3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM 3D - KratosStructure 3D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Turek benchmark
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Turek benchmark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="turek_fluent2d_abaqus2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="turek_fluent2d_abaqus2d_steady.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fluent 2D - Abaqus 2D - Steady
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="turek_openfoam2d_kratos_structure2d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenFOAM 2D - KratosStructure 2D
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="test_single_solver.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test single solver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="tests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tests
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="models">Models</h1>
<p>This documentation describes the different types of available models. The purpose of a model always is to provide a (approximated) (inverse) Jacobian of a system.
Often this achieved with the help of secant information from input-output-pairs, resulting in a so-called quasi-Newton method.
Another approach to obtain an approximated Jacobian is the use of a surrogate model. Finally, in some cases, the Jacobian can be derived analytically.
These three types of models will be discussed further. More detailed information can be found in Delaiss√© et al. [<a href="#8">8</a>].</p>
<p>Which Jacobian is approximated in practice will depend on the use of the model in the coupled solver.
For example, using the coupled solver <code>CoupledSolverIQNI</code> with the model <code>ModelLS</code> corresponds to the IQN-ILS method developed by Degroote et al. [<a href="#1">1</a>]. In that case, the approximated Jacobian is <span class="arithmatex"><span class="MathJax_Preview">\mathcal{R}'^{-1}</span><script type="math/tex">\mathcal{R}'^{-1}</script></span>.
If the coupled solver <code>CoupledSolverIBQN</code> is combined with two instances the model <code>ModelLS</code>, the resulting algorithm corresponds to the IBQN-LS method developed by Vierendeels et al. [<a href="#2">2</a>]. Then, the two models each approximate one Jacobian: <span class="arithmatex"><span class="MathJax_Preview">\mathcal{F}'</span><script type="math/tex">\mathcal{F}'</script></span> and <span class="arithmatex"><span class="MathJax_Preview">\mathcal{S}'</span><script type="math/tex">\mathcal{S}'</script></span>.
Refer to the <a href="https://pyfsi.github.io/coconut/coupled_solvers">coupled solvers documentation</a> for more information on these notations.</p>
<h2 id="common-methods">Common methods</h2>
<p>There are four model-specific methods, which are implemented by all models.</p>
<ul>
<li>The first of which is the <code>predict(dr)</code> method, which returns an estimation of the change in output variable based on a change in input variable using the Jacobian approximation.</li>
<li>Second, the method <code>is_ready()</code> return a boolean signalling if the model is ready to <em>predict</em> using the previous method.</li>
<li>Third, in order to improve the estimation, information from a current iteration can be added to the model using the method <code>add(r, xt)</code>.</li>
<li>And finally, the method <code>filter_q(dr)</code> returns the part of supplied vector which falls inside the nullspace of the Jacobian. This is the part of the supplied vector for which the model has no derivative information.</li>
</ul>
<h2 id="jacobian-approximation-from-secant-information">Jacobian approximation from secant information</h2>
<p>In order to approximate the Jacobian <span class="arithmatex"><span class="MathJax_Preview">\mathcal{A}'</span><script type="math/tex">\mathcal{A}'</script></span> of a general function <span class="arithmatex"><span class="MathJax_Preview">a=\mathcal{A}(b)</span><script type="math/tex">a=\mathcal{A}(b)</script></span>, the model needs to be supplied with matching input-output-pairs, (<span class="arithmatex"><span class="MathJax_Preview">b^i</span><script type="math/tex">b^i</script></span>, <span class="arithmatex"><span class="MathJax_Preview">a^i=\mathcal{A}(b^i)</span><script type="math/tex">a^i=\mathcal{A}(b^i)</script></span>).
Once at least two pairs have been supplied, the model is able to approximately predict the product of the Jacobian with an arbitrary vector <span class="arithmatex"><span class="MathJax_Preview">\Delta b</span><script type="math/tex">\Delta b</script></span>.
In other words, when a vector <span class="arithmatex"><span class="MathJax_Preview">\Delta b</span><script type="math/tex">\Delta b</script></span> is given it outputs <span class="arithmatex"><span class="MathJax_Preview">\Delta a=\widehat{\mathcal{A}}'\Delta b</span><script type="math/tex">\Delta a=\widehat{\mathcal{A}}'\Delta b</script></span>, where the hat symbol is used to denote that an approximation of the Jacobain is used.</p>
<p>In the following, the example from IQN-ILS will be used: the inverse Jacobian of <span class="arithmatex"><span class="MathJax_Preview">\mathcal{R}'</span><script type="math/tex">\mathcal{R}'</script></span> with respect to <span class="arithmatex"><span class="MathJax_Preview">\widetilde{x}</span><script type="math/tex">\widetilde{x}</script></span> is approximated which has an input vector <span class="arithmatex"><span class="MathJax_Preview">r</span><script type="math/tex">r</script></span> and an output vector <span class="arithmatex"><span class="MathJax_Preview">\widetilde{x}</span><script type="math/tex">\widetilde{x}</script></span>.
For brevity, the approximation will be denoted by <span class="arithmatex"><span class="MathJax_Preview">N^k</span><script type="math/tex">N^k</script></span>, where the superscript <span class="arithmatex"><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> referes to the iteration.</p>
<p>The four model-specific methods can be made concrete for this type of model:</p>
<ul>
<li>The <code>predict(dr)</code> method returns an estimation of <span class="arithmatex"><span class="MathJax_Preview">\Delta \widetilde{x}=N^k\Delta r</span><script type="math/tex">\Delta \widetilde{x}=N^k\Delta r</script></span> from an input <span class="arithmatex"><span class="MathJax_Preview">\Delta r</span><script type="math/tex">\Delta r</script></span>, based on stored input-output-pairs.</li>
<li>The method <code>is_ready()</code> return a boolean signalling if the <code>model</code> is ready to <em>predict</em> using the previous method. This is the case when two input-output-pairs have been added.</li>
<li>The method <code>add(r, xt)</code> adds an input-output-pair to the model in order to improve the estimation.</li>
<li>The method <code>filter_q(dr)</code> returns the part of vector <span class="arithmatex"><span class="MathJax_Preview">\Delta r</span><script type="math/tex">\Delta r</script></span> which is orthogonal to the columnspace of the matrix containing the differences between consecutively stored inputs. This is the part of the input vector <span class="arithmatex"><span class="MathJax_Preview">\Delta r</span><script type="math/tex">\Delta r</script></span> for which the deficient approximation of the Jacobian holds no information.</li>
</ul>
<p>Three different methods in this category are discussed.</p>
<h3 id="least-squares">Least-squares</h3>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.ls</code>.
The abbreviation LS stands for <em>least-squares</em>.</p>
<p>From the received input vectors <span class="arithmatex"><span class="MathJax_Preview">r^i</span><script type="math/tex">r^i</script></span> and output vectors <span class="arithmatex"><span class="MathJax_Preview">\widetilde{x}^i</span><script type="math/tex">\widetilde{x}^i</script></span>, differences are constructed
$$
\delta r^{i-1}=r^i-r^{i-1},
\;
\delta \widetilde{x}^{i-1}=\widetilde{x}^i-\widetilde{x}^{i-1}.
$$
These are stored as column of the matrices <span class="arithmatex"><span class="MathJax_Preview">V</span><script type="math/tex">V</script></span> and <span class="arithmatex"><span class="MathJax_Preview">W</span><script type="math/tex">W</script></span>.
This model requires the approximation of the Jacobian, denoted by <span class="arithmatex"><span class="MathJax_Preview">N^k</span><script type="math/tex">N^k</script></span>, to fulfill the secant equations:
$$
W=N^k V.
$$
In addition to this a minimal norm requirement is imposed (hence the name).</p>
<p>The differences can be limited to the current time step only. However, using the reuse parameter <code>q</code>, the differences from the <code>q</code> previous time steps are included as well.
It is important to note that differences between the input and outputs from different time steps are not considered.
Reuse may greatly improve the convergence speed and stability. The optimal value of <code>q</code> is problem dependent. Typically, however, an optimal value is around 10.</p>
<p>This model is matrix-free, due to an implementation using QR-decomposition. With matrix-free is meant that no large dense matrices are constructed, not that no matrices are used at all.
The <span class="arithmatex"><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span> matrix from the QR-decomposition has to be invertible. Therefore, (almost) linearly dependent columns in the matrix containing the input information from the current and previous time steps should be removed. This is called filtering. The larger <code>q</code>, the more important filtering becomes.
If the diagonal element in <span class="arithmatex"><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span> is smaller than an absolute tolerance level <code>min_significant</code>, the corresponding column is removed.
The implementation is as such that the most recent information is kept.</p>
<p>For more information refer to [<a href="#3">3</a>].</p>
<p>As mentioned before, the combination of this model wiht the coupled solver <code>CoupledSolverIQNI</code> corresponds to the IQN-ILS method developed by Degroote et al. [<a href="#1">1</a>], while using twice this model with the coupled solver <code>CoupledSolverIBQN</code> corresponds to the IBQN-LS method developed by Vierendeels et al. [<a href="#2">2</a>].</p>
<p>The following parameters need to be included in the <code>settings</code> dictionary.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>min_significant</code></nobr></td>
<td style="text-align: center;">double</td>
<td>Absolute tolerance for filtering. To disable filtering, set to <code>0</code>.</td>
</tr>
<tr>
<td style="text-align: right;"><code>q</code></td>
<td style="text-align: center;">int</td>
<td>Number of previous time steps that are reused. In a steady simulation, there are no previous time steps, so then the value is irrelevant.</td>
</tr>
</tbody>
</table>
<h3 id="multi-vector">Multi-vector</h3>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.mv</code>. The abbreviation MV stands for <em>multi-vector</em>.</p>
<p>In this model, differences are constructed similar to the least-squares model. However, it requires the approximation <span class="arithmatex"><span class="MathJax_Preview">N^k</span><script type="math/tex">N^k</script></span> to fulfill the secant equations of the current time step only. Moreover, it is required that the approximation is as close as possible to the previous time step. In this model large dense matrices are constructed and is hence discouraged for cases with a large number of degrees of freedom on the interface.</p>
<p>Filtering can also be applied here, then (almost) linear columns in the matrix containing the input information from the current time step are removed. However, filtering is much less critical compared to the <code>LS</code> model as it concerns only the information from the current time step. If no filtering is wanted, the tolerance level should be set to zero.</p>
<p>For more information refer to [<a href="#3">3</a>].</p>
<p>The combination of this model with the coupled solver <code>CoupledSolverIQNI</code> corresponds to the IQN-MVJ from Lindner et al. [<a href="#4">4</a>], while using twice this model with the coupled solver <code>CoupledSolverIBQN</code> corresponds to the MVQN method developed by Bogaers et al. [<a href="#5">5</a>].</p>
<p>The following parameter needs to be included in the <code>settings</code> dictionary.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>min_significant</code></nobr></td>
<td style="text-align: center;">double</td>
<td>(optional) Default: <code>0</code> (disabled). Absolute tolerance for filtering.</td>
</tr>
</tbody>
</table>
<h3 id="multi-vector-matrix-free">Multi-vector matrix-free</h3>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.mvmf</code>. The abbreviation MV-MF stands for <em>multi-vector matrix-free</em>.</p>
<p>By combining the QR-approach from the least-squares model with the time step wise storage of secant information, a matrix-free implementation of the multi-vector approach is obtained quite naturally. This implementation was also thought of by Spenke et al. [<a href="#6">6</a>] and is part of the IQN-ILSM framework [<a href="#7">7</a>].</p>
<p>In this approach, the contribution of each time step is grouped into a separate term, where the most recent time step has priority over the later ones. Therefore, a parameter <code>q</code> is used to denote how many time steps are reused. Setting this parameter very large, this model will act the same as <code>MV</code>, which reuses all time steps. Generally, the performance will increase when this parameter is chosen larger, but so will be the computational cost. Nonetheless, this cost is much smaller compared to the non-matrix-free multi-vector approach.</p>
<p>Filtering can be applied similar to the above described models, but this is typically not necessary.</p>
<p>The following parameters need to be included in the <code>settings</code> dictionary.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>min_significant</code></nobr></td>
<td style="text-align: center;">double</td>
<td>(optional) Default: <code>0</code> (disabled). Absolute tolerance for filtering.</td>
</tr>
<tr>
<td style="text-align: right;"><code>q</code></td>
<td style="text-align: center;">int</td>
<td>Number of previous time steps that are reused. In a steady simulation there are no previous time steps, so then it should be 0.</td>
</tr>
</tbody>
</table>
<h2 id="jacobian-approximation-from-surrogate-model">Jacobian approximation from surrogate model</h2>
<h3 id="surrogate">Surrogate</h3>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.surrogate</code>.</p>
<p>Instead of relying on previously obtained input-output-pairs, this model uses a surrogate model to approximate the Jacobian.
To achieve this a surrogate coupled calculation is performed at the start of every time step.
From this calculation the Jacobian is extracted and used as approximation for the actual calculation.
Besides the Jacobian, also the solution can be used as prediction for the actual calculation using the <a href="https://pyfsi.github.io/coconut/predictors#surrogate">surrogate predictor</a>.
Once the actual calculation has converged, the surrogate can be <em>synchronized</em> with the actual solution. For more information refer to the <a href="https://pyfsi.github.io/coconut/coupled_solvers#iqnism"><code>CoupledSolverIQNISM</code></a>.</p>
<p>Beside the four methods shared by all models, this one has two additional important methods:</p>
<ul>
<li>The method <code>get_solution</code> starts the surrogate coupled calculation and returns the solution.</li>
<li>The method <code>set_solution</code> allows to provide an interface solution that is used to perform one iteration (flow solver calculation and using result for structural solver calculation). In this way the surrogate can be <em>synchronized</em> with actual calculation. This method does not need to be implemented.</li>
</ul>
<p>The surrogate coupled calculation is performed with a <code>coupled_solver</code> that has its own <code>predictor</code>, <code>convergence_criterion</code>, <code>solver_wrappers</code> and coupling algorithm.
The surrogate solver_wrappers should be cheaper to calculate, but still representative for the actual solver wrappers.
For example, they might solve the same equations, but on a coarser mesh. Or, they might be a simplified 1D solver that can approximate the actual 2D or 3D simulation.
Similarly, 2D surrogate solver wrappers can approximate a 3D calculation, for an axisymmetric case. For more details refer to [<a href="#7">7</a>].</p>
<p>The following parameter needs to be included in the <code>settings</code> dictionary.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><nobr><code>coupled_solver</code></nobr></td>
<td style="text-align: center;">dict</td>
<td>Dictionary of the coupled solver used for the surrogate coupled calculation. The following parameter are not required in the <code>settings</code> of <code>coupled_solver</code>, as they are inherited from a higher component: <code>delta_t</code>, <code>save_restart</code>, <code>timestep_start</code>. The <code>case_name</code> parameter is set by default to <code>&lt;case_name&gt;_surrogate</code>, where <code>&lt;case_name&gt;</code> is the value of the <code>coupled_solver</code>, where this <code>surrogate</code> model is part of.</td>
</tr>
</tbody>
</table>
<h3 id="mapped">Mapped</h3>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.mapped</code>.</p>
<p>As a <code>surrogate</code> model usually won't have the same discretization as the actual solvers, mapping capabilities are provided.
This special model acts analogously, to the <a href="https://pyfsi.github.io/coconut/mappers"><code>mapped</code> solver wrapper</a>.
It contains 3 <code>Components</code>: a mapper for the input, a real model and a mapper for the output.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><code>mapper_interface_input</code></td>
<td style="text-align: center;">dict</td>
<td>Interface input mapper.</td>
</tr>
<tr>
<td style="text-align: right;"><nobr><code>mapper_interface_output</code></nobr></td>
<td style="text-align: center;">dict</td>
<td>Interface output mapper.</td>
</tr>
<tr>
<td style="text-align: right;"><code>surrogate</code></td>
<td style="text-align: center;">dict</td>
<td>Dictionary of a model, e.g. <code>surrogate</code>.</td>
</tr>
</tbody>
</table>
<h2 id="analytically-determined-jacobian">Analytically determined Jacobian</h2>
<p>Analytically determining the Jacobian is only possible for very simple solvers.
One such <code>model</code> is available, that accomplishes this for the combination of the <a href="https://pyfsi.github.io/coconut/python#tube-flow-solver">python tube flow solver</a> and <a href="https://pyfsi.github.io/coconut/python#tube-structure-solver">python tube structure solver</a>.
This code can also serve as example or template for the use of own analytically determined Jacobians.</p>
<h3 id="analytical-1d">Analytical 1D</h3>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.analytical_1d</code>.
This <code>model</code> creates it own two <code>solver_wrappers</code> (<code>tube flow solver</code> and <code>tube structure solver</code>) that should be equal to the <code>solver_wrappers</code> used in the <code>coupled_solver</code>.
A flow Jacobian and structure Jacobian are called from these <code>solver_wrappers</code> and combined to obtain the final Jacobian. For more information refer to [<a href="#7">7</a>].</p>
<p>This Jacobian can be updated every iteration. Then the Jacobian will be determined in the current solution.
Typically, however, this is not advised because the Jacobian doesn't change that much from iteration to iteration and because the computation of the Jacobian is rather expensive, as it involves explict matrix construction and storage as well as inversion of square dense matrices.</p>
<p>The following parameters need to be included in the <code>settings</code> dictionary.</p>
<table>
<thead>
<tr>
<th style="text-align: right;">parameter</th>
<th style="text-align: center;">type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;"><code>solver_models</code></td>
<td style="text-align: center;">list</td>
<td>List of <code>solver_wrappers</code> to be used by the <code>model</code>: <code>tube flow solver</code> and <code>tube structure solver</code>. Normally these are equal to the ones used by the <code>coupled_solver</code>.</td>
</tr>
<tr>
<td style="text-align: right;"><nobr><code>update_every_iteration</code></nobr></td>
<td style="text-align: center;">bool</td>
<td>(optional) Default: <code>false</code>. Whether or not the Jacobian has to be recalculated every iteration (using the solution of the previous iteration).</td>
</tr>
</tbody>
</table>
<h2 id="restart">Restart</h2>
<p>The settings of a model may be changed upon restart.
When increasing the reuse parameter <code>q</code>, the number of time steps stored will build up gradually until the final number is reached.
Decreasing <code>q</code> occurs instantly.</p>
<h2 id="dummy-model">Dummy model</h2>
<p>The <code>type</code> for this model is <code>coupled_solvers.models.dummy_model</code>.</p>
<p>This special dummy model can be used in a coupled solver that requires a secant or surrogate model, without the model actually performing any secant or surrogate calculation. (e.g. in <a href="https://pyfsi.github.io/coconut/coupled_solvers#iqnism">CoupledSolverIQNISM</a>)
This model will not provide any (surrogate) Jacobian approximation nor surrogate solution if used as surrogate model.</p>
<p>If the use of a dummy model is allowed, the <code>type</code> (<code>coupled_solvers.models.dummy_model</code>) can be written explicitly or omitted. No <code>settings</code> are required.</p>
<h2 id="references">References</h2>
<p><a id="1">[1]</a> 
<a href="http://hdl.handle.net/1854/LU-533365">Degroote J., Bathe K.-J. and Vierendeels J., "Performance of a new partitioned procedure versus a monolithic procedure in fluid-structure interaction", Computers &amp; Structures, vol. 87, no. 11‚Äì12, pp. 793-801, 2009.</a></p>
<p><a id="2">[2]</a> 
<a href="http://hdl.handle.net/1854/LU-409369">Vierendeels J., Lanoye L., Degroote J. and Verdonck P., "Implicit coupling of partitioned fluid-structure interaction problems with reduced order models", Computers &amp; Structures, vol. 85, no. 11‚Äì14, pp. 970‚Äì976, 2007.</a></p>
<p><a id="3">[3]</a> 
<a href="http://hdl.handle.net/1854/LU-8685199">Delaiss√© N., Demeester T., Fauconnier D. and Degroote J., "Comparison of different quasi-Newton techniques for coupling of black box solvers", in ECCOMAS 2020, Proceedings, Paris, France, 2021.</a></p>
<p><a id="4">[4]</a> 
<a href="https://www.researchgate.net/publication/277077208_A_Comparison_of_various_Quasi-Newton_Schemes_for_Partitioned_Fluid-Structure_Interaction">Lindner F., Mehl M., Scheufele K. and Uekermann B., "A comparison of various quasi-Newton schemes for partitioned fluid-structure interaction", in: B. Schrefler, E. O√±ate, M. Papadrakakis (Eds.), 6th International Conference on Computational 975 Methods for Coupled Problems in Science and Engineering, pp. 477‚Äì488, 2015.</a></p>
<p><a id="5">[5]</a> 
<a href="https://doi.org/10.1016/j.cma.2014.06.033">Bogaers A., Kok S., Reddy B. and Franz T., "Quasi-Newton methods for implicit black-box FSI coupling", ComputerMethods in AppliedMechanics and Engineering, vol. 279, pp. 113‚Äì132, 2014.</a></p>
<p><a id="6">[6]</a> 
<a href="https://doi.org/10.1016/j.cma.2019.112810">Spenke T., Hosters N. and Behr M., "A multi-vector interface quasi-newton method with linear complexity for partitioned fluid‚Äìstructure interaction", Computer Methods in Applied Mechanics and Engineering, vol. 361, pp. 112810, 2020.</a></p>
<p><a id="7">[7]</a>
<a href="http://hdl.handle.net/1854/LU-8728347">Delaiss√© N., Demeester T., Fauconnier D. and Degroote J., "Surrogate-based acceleration of quasi-Newton techniques for fluid-structure interaction simulations", Computers &amp; Structures, vol. 260, pp. 106720, 2022.</a></p>
<p><a id="8">[8]</a> 
<a href="https://doi.org/10.1007/s11831-023-09907-y">Delaiss√©, N., Demeester, T., Haelterman, R. and Degroote J., "Quasi-Newton methods for partitioned simulation of fluid-structure interaction reviewed in the generalized Broyden framework", Archives of Computational Methods in Engineering, vol. 30, pp. 3271-3300, 2023.</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.expand", "navigation.tracking", "toc.integrate"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>